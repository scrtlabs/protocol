

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>System design &mdash; Enigma Protocol 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Enigma Protocol 0.1 documentation" href="index.html"/>
        <link rel="next" title="Enigma-js" href="Enigma-js.html"/>
        <link rel="prev" title="Getting started" href="GettingStarted.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Enigma Protocol
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="HowToUseThisDocumentation.html">How to use this documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="AboutThisRelease.html">About this release</a><ul>
<li class="toctree-l2"><a class="reference internal" href="AboutThisRelease.html#selected-features-of-this-release">Selected features of this release</a></li>
<li class="toctree-l2"><a class="reference internal" href="AboutThisRelease.html#assumptions-made-in-this-testnet-release">Assumptions made in this testnet release</a></li>
<li class="toctree-l2"><a class="reference internal" href="AboutThisRelease.html#on-rust">On Rust</a></li>
<li class="toctree-l2"><a class="reference internal" href="AboutThisRelease.html#on-sgx">On SGX</a></li>
<li class="toctree-l2"><a class="reference internal" href="AboutThisRelease.html#on-coupling-with-ethereum">On Coupling with Ethereum</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="GettingStarted.html#hardware-requirements">Hardware Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="GettingStarted.html#software-requirements">Software Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="GettingStarted.html#your-first-secret-contract">Your First Secret Contract</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">System design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#enigma-js-client-library">Enigma-JS Client Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enigma-contract">Enigma Contract</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tracking-of-computation-tasks">Tracking of Computation Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#events">Events</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#principal-node">Principal Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enigma-node">Enigma Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="#surface">Surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#core">Core</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Enigma-js.html">Enigma-js</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Enigma-js.html#validatekeyhex"><strong>validateKeyHex</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Enigma-js.html#getderivedkey"><strong>getDerivedKey</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Enigma-js.html#encryptmessage"><strong>encryptMessage</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Enigma-js.html#getpublickey"><strong>getPublicKey</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Enigma-js.html#removetrailing0x"><strong>removeTrailing0x</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Enigma-js.html#recoverpubkey"><strong>recoverPubKey</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Enigma-js.html#verifysignature"><strong>verifySignature</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="Enigma-js.html#selectworker"><strong>selectWorker</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="NetworkTopology.html">Network topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="Community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="SoftwareArchitecture.html">Software architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="SoftwareArchitecture.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="SoftwareArchitecture.html#subsystem-decomposition">Subsystem Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="SoftwareArchitecture.html#logical-components">Logical Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="SoftwareArchitecture.html#mapping-between-subsystems-and-logical-components">Mapping Between Subsystems and Logical Components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SubsystemArchitecture.html">Subsystem architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="SubsystemArchitecture.html#registration">Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="SubsystemArchitecture.html#client-encryption-and-storage">Client Encryption and Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="SubsystemArchitecture.html#worker-selection">Worker Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="SubsystemArchitecture.html#computation">Computation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SubsystemArchitecture.html#payment-of-the-computation-fee">Payment of the Computation Fee</a></li>
<li class="toctree-l3"><a class="reference internal" href="SubsystemArchitecture.html#deserialization-and-decryption">Deserialization and Decryption</a></li>
<li class="toctree-l3"><a class="reference internal" href="SubsystemArchitecture.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="SubsystemArchitecture.html#execution-in-evm">Execution in EVM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SubsystemArchitecture.html#on-chain-verification">On-Chain Verification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SubsystemArchitecture.html#after-each-new-epoch">After Each New Epoch</a></li>
<li class="toctree-l3"><a class="reference internal" href="SubsystemArchitecture.html#post-computation">Post Computation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SubsystemArchitecture.html#attestation">Attestation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Enigma Protocol</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>System design</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/SystemDesign.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="system-design">
<h1>System design<a class="headerlink" href="#system-design" title="Permalink to this headline">¶</a></h1>
<p>This section gives an overview of important components of our testnet
release for developers. It discusses each component at a high level:
more in-depth discussion can be found in System Architecture and
Subsystem Architecture sections.</p>
<p>The core of the Enigma network is the ability to perform private computations.
A private computation task is a function that is run over data that is not seen by any node. These tasks are initiated by the end-users of Ethereum dApps, then offloaded to the Enigma network via the Enigma Contract. The Enigma network selects workers running Enigma nodes to perform the computations, and then returns the result to the ethereum dApp contract. Encryption of the data happens on the client side, before data is submitted to the ethereum dApp.</p>
<p>To create a private computation task, developers use the Enigma-JS
client library.</p>
<div class="section" id="enigma-js-client-library">
<h2>Enigma-JS Client Library<a class="headerlink" href="#enigma-js-client-library" title="Permalink to this headline">¶</a></h2>
<p>The Enigma client library, <a class="reference external" href="#_ydldonl0i1f1">Enigma-JS</a>, is a
javascript library that interfaces with the Enigma protocol. The API for
this library describes tasks that a dApp will require to interact with
Enigma, such as encryption and verification. Enigma-JS contains tools
to: 1) safely encrypt sensitive data in-memory for immediate use or
storage; 2) obtain an authoritative proof that the target worker is
securely running trusted hardware prior to sending data and paying fees.
(Trusted hardware for this release means Intel SGX: for more information
on SGX, see sections On SGX and Registration)</p>
</div>
<div class="section" id="enigma-contract">
<span id="id1"></span><h2>Enigma Contract<a class="headerlink" href="#enigma-contract" title="Permalink to this headline">¶</a></h2>
<p>The Enigma contract primarily contains logic to secure the network. To do this, it has a list of registered worker nodes. It receives computation task requests from Dapps, and broadcasts them to the Enigma Network. It can also verify the integrity of the results submitted by each worker. The sections below describe the key characteristics of the Enigma contract.</p>
<div class="section" id="tracking-of-computation-tasks">
<h3>Tracking of Computation Tasks<a class="headerlink" href="#tracking-of-computation-tasks" title="Permalink to this headline">¶</a></h3>
<p>The computation tasks are stored in a mapping using the Task struct.
Each active task item contains the computation fee (in ENG) paid by the
Dapp user.</p>
</div>
<div class="section" id="events">
<h3>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h3>
<p>The following lists breaks down the key events emitted by the contract.</p>
<p>1. <strong>ComputeTask</strong>:
Gives workers the parameters of a computation task</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><strong>callable:</strong> A variation of method signature (see Ethereum ABI <a href="#id3"><span class="problematic" id="id4"><span id="id2"></span>[3]_</span></a>) of a public function of the Dapp contract which contains the computation logic (callable). The only variation is an additional prefix which flags encrypted values. The type of each encrypted argument must have a <em>“_”</em> prefix in the signature. For example, if the first argument of <em>baz(uint32,bool)</em> is encrypted, the signature becomes <em>baz(_uint32,bool)</em>.</li>
<li><strong>callableArgs:</strong> The encrypted argument value(s) of the callable function. These inputs must be encrypted a priori (see Client section below). They cannot be provided in the clear. Their original types will be inferred from the callable function definition. In the Coin Mixing example, it is an array of encrypted destination addresses.</li>
<li><strong>callback:</strong> The method signature (see Ethereum ABI) of a public function of the Dapp contract which the worker calls when committing the results.</li>
<li><strong>preprocessors</strong>: A list of well-known preprocessor functions which will inject calculated arguments at runtime (when the callable function runs in the EVM). For example, a “random” pre-processor might inject an array of random integers for shuffling.</li>
<li><strong>fee</strong>: The computation fee (in ENG) to be in held in escrow until the computation is completed.</li>
</ol>
</div></blockquote>
<p>2. <strong>WorkersParameterized</strong>:
Gives workers the parameters that are required for selection</p>
<blockquote>
<div><ol class="loweralpha simple" start="6">
<li><strong>seed</strong>: The random sampling seed effective in the current block.</li>
<li><strong>activeWorkers</strong>: An ordered list of addresses of all registered workers</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="principal-node">
<h2>Principal Node<a class="headerlink" href="#principal-node" title="Permalink to this headline">¶</a></h2>
<p>The principal node is a temporary centralized node which performs two
key functions: 1) Generate random seeds for worker selection; 2)
Propagate the encryption key to other nodes joining the network. The
principal node exists in this developer release only. Using this
component achieves true randomness while simplifying the architecture.
In future releases, this component will be replaced by a completely
decentralized scheme which will also achieve true randomness.</p>
</div>
<div class="section" id="enigma-node">
<h2>Enigma Node<a class="headerlink" href="#enigma-node" title="Permalink to this headline">¶</a></h2>
<p>An Enigma Node is composed of two components: Surface and Core.</p>
<img alt="Surface to Core Diagram" class="align-center" src="https://s3.amazonaws.com/enigmaco-docs/protocol/surface-to-core.png" />
</div>
<div class="section" id="surface">
<h2>Surface<a class="headerlink" href="#surface" title="Permalink to this headline">¶</a></h2>
<p>Surface is the untrusted component of an Enigma node which has the
primary function of coordinating computation tasks between the Enigma
Contract and Core. Surface is involved in worker selection and
computation tasks. For the tasks in each process, the Enigma network has
verification protocols that check correct execution. For information on
Surface’s role in the registration process, see
<a class="reference external" href="#registration">Registration</a>. For more details on how Surface is
used in the computation process, see <a class="reference external" href="#computation">Computation</a>.</p>
</div>
<div class="section" id="core">
<h2>Core<a class="headerlink" href="#core" title="Permalink to this headline">¶</a></h2>
<p>Core is the trusted component of the Enigma network, and executes
computation tasks. Core runs inside of an <a class="reference external" href="#on-sgx">SGX enclave</a>.
Core is involved in a number of processes, including registration,
encryption, computation and validation. Core is responsible for the
decryption of data, processing of computations, and returning results to
the Enigma function. The Enigma function is able to verify that each of
these tasks was executed correctly with Core. For more information about
these processes, see <a class="reference external" href="#computation">Computation</a>,
<a class="reference external" href="#registration">Registration</a>, and <a class="reference external" href="#attestation">Attestation</a>
sections.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Enigma-js.html" class="btn btn-neutral float-right" title="Enigma-js" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="GettingStarted.html" class="btn btn-neutral" title="Getting started" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Enigma MPC, Inc..
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>